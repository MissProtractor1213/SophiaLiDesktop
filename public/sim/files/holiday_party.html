<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Holiday_Party_List.xlsx - Excel</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root{
    --excel-green:#217346;
    --excel-green-dark:#185c36;
    --grid:#d9d9d9;
    --header-bg:#f3f6fb;
    --row-alt:#fafafa;
    --font:"Segoe UI", Calibri, Helvetica, Arial, sans-serif;
    --festive:#b80f28; /* subtle red accent */
  }
  html,body{height:100%}
  body{margin:0;background:#fff;color:#111;font-family:var(--font)}

  /* Title bar (Excel-like) */
  .titlebar{
    background:var(--excel-green);color:#fff;padding:8px 12px;font-size:14px;display:flex;align-items:center;gap:12px
  }
  .titlebar .filename{font-weight:600}

  /* Ribbon */
  .ribbon{background:#f7f7f7;border-bottom:1px solid #e6e6e6;padding:6px 10px;font-size:12px;display:flex;align-items:center;gap:14px;flex-wrap:wrap}
  .ribbon .group{display:flex;align-items:center;gap:8px;padding:4px 8px;border-right:1px solid #eee}
  .ribbon .btn{border:1px solid #ddd;background:#fff;padding:4px 8px;border-radius:4px;cursor:pointer}
  .ribbon .btn:hover{background:#f0f0f0}
  .ribbon .tab{font-weight:600;color:var(--excel-green-dark)}
  .ribbon .chip{background:#fff;border:1px solid #ddd;border-radius:999px;padding:3px 8px}

  /* Formula bar */
  .formula{display:grid;grid-template-columns:80px 1fr;gap:8px;align-items:center;padding:6px 10px;border-bottom:1px solid #eee;background:#fafafa;font-size:12px}
  .fx,.namebox{background:#fff;border:1px solid #ddd;border-radius:4px;padding:4px 8px;color:#444}
  .namebox{width:70px}

  /* Grid scaffolding */
  .grid-wrap{display:grid;grid-template-rows:auto 1fr auto;height:calc(100% - 92px)}
  .sheet{display:grid;grid-template-columns:60px 1fr;height:100%;overflow:hidden}

  .colhdrs{
    position:sticky;top:0;z-index:3;background:#fff;border-bottom:1px solid var(--grid);
    display:grid;grid-template-columns:
      repeat(13, minmax(140px, 1fr));
    margin-left:60px
  }
  .colhdr{
    font-size:12px;font-weight:600;background:var(--header-bg);
    border-right:1px solid var(--grid);padding:8px;display:flex;align-items:center;gap:6px
  }
  .colhdr .filter{margin-left:auto;font-size:10px;opacity:.7}
  .colhdr:last-child{border-right:none}

  .grid{
    display:grid;
    grid-template-columns:60px repeat(13, minmax(140px, 1fr));
    height:100%;overflow:auto;border-top:1px solid var(--grid)
  }

  /* Row numbers */
  .rnum{
    position:sticky;left:0;z-index:2;background:#f6f6f6;border-right:1px solid var(--grid);
    padding:6px 8px;font-size:12px;text-align:right;color:#666
  }

  /* Cells */
  .cell{
    border-right:1px solid var(--grid);border-bottom:1px solid var(--grid);
    padding:6px 8px;font-size:13px;background:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis
  }
  .row:nth-child(even) .cell{background:var(--row-alt)}

  /* Checkbox look */
  .chk{display:inline-block;width:14px;height:14px;border:1px solid #999;border-radius:2px;vertical-align:middle;margin-right:6px}
  .chk.on{background:linear-gradient(#d4f0d4,#bfe7bf);border-color:#6ab66a;box-shadow:inset 0 0 0 2px #fff}

  /* Festive tag */
  .tag{display:inline-block;font-size:11px;padding:2px 6px;border:1px solid #ccc;border-radius:10px;margin-right:6px}
  .tag.veggie{border-color:#6ab66a;background:#eaf7ea}
  .tag.allergy{border-color:#e0a04b;background:#fff6e8}
  .tag.vip{border-color:#9aa7ec;background:#eef0ff}

  /* Sheet tabs */
  .tabs{display:flex;gap:8px;align-items:center;padding:6px 10px;border-top:1px solid #e6e6e6;background:#fafafa}
  .tabbtn{padding:6px 12px;background:#fff;border:1px solid #ddd;border-bottom-color:#fff;border-radius:6px 6px 0 0;font-size:12px;cursor:pointer}
  .tabbtn.active{font-weight:600;color:var(--excel-green);border-color:#ccc;background:#fff}
  .status{margin-left:auto;font-size:12px;color:#666}

  /* Sticky corner (for A1 box look) */
  .abc{
    position:sticky;top:0;left:0;z-index:4;background:#f6f6f6;border-right:1px solid var(--grid);
    width:60px;height:34px;display:flex;align-items:center;justify-content:center;font-size:12px;color:#666
  }

  /* Festive top note */
  .note-bar{
    background:linear-gradient(90deg, #fff, #fff0f2);
    border-bottom:1px solid #f0d6db;
    color:#7a0b1d;
    padding:8px 12px;
    display:flex; align-items:center; gap:10px; font-size:12px
  }
  .note-bar .dot{width:6px;height:6px;border-radius:50%;background:var(--festive)}
  /* Responsive min width for headers */
  .colhdrs{min-width:1960px}
</style>
</head>
<body>
  <div class="titlebar">
    <span class="filename">Holiday_Party_List.xlsx</span>
  </div>

  <div class="note-bar">
    <span class="dot"></span>
    Holiday Party — December 14, 2025 • Venue: Grand Ballroom • Check-in opens 6:00 PM • Dress Code: Festive
  </div>

  <div class="ribbon" role="toolbar" aria-label="Ribbon">
    <span class="tab">Home</span>
    <div class="group">
      <button class="btn" id="exportCsvBtn" title="Export table as CSV">Export CSV</button>
      <button class="btn" onclick="window.print()">Print</button>
    </div>
    <div class="group">
      <span>View</span>
      <button class="btn" id="wrapBtn">Wrap Text</button>
    </div>
    <div class="group">
      <span>Counts</span>
      <span class="chip" id="rsvpCount">RSVP Yes: 0</span>
      <span class="chip" id="mealCounts">Meals: —</span>
    </div>
  </div>

  <div class="formula">
    <div class="namebox">A1</div>
    <div class="fx">=Holiday_Party_List</div>
  </div>

  <div class="grid-wrap">
    <!-- Column headers -->
    <div class="colhdrs" aria-hidden="true">
      <div class="colhdr">Full Name <span class="filter">▼</span></div>
      <div class="colhdr">Department <span class="filter">▼</span></div>
      <div class="colhdr">RSVP <span class="filter">▼</span></div>
      <div class="colhdr">Meal Pref <span class="filter">▼</span></div>
      <div class="colhdr">Allergies <span class="filter">▼</span></div>
      <div class="colhdr">+1 Name <span class="filter">▼</span></div>
      <div class="colhdr">+1 Meal <span class="filter">▼</span></div>
      <div class="colhdr">Table # <span class="filter">▼</span></div>
      <div class="colhdr">Drink Tickets <span class="filter">▼</span></div>
      <div class="colhdr">Gift Received <span class="filter">▼</span></div>
      <div class="colhdr">Arrival Time <span class="filter">▼</span></div>
      <div class="colhdr">Checked In <span class="filter">▼</span></div>
      <div class="colhdr">Notes <span class="filter">▼</span></div>
    </div>

    <!-- Grid -->
    <div class="sheet">
      <div class="grid" role="table" aria-label="Holiday Party List">
        <div class="abc"> </div>

        <!-- Row 1 -->
        <div class="rnum">1</div>
        <div class="cell">Sophia Li</div>
        <div class="cell">HR</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">Veggie</div>
        <div class="cell"><span class="tag allergy">Peanuts</span></div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">3</div>
        <div class="cell">2</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">6:05 PM</div>
        <div class="cell"><span class="chk on"></span>✔</div>
        <div class="cell">Seated near stage</div>

        <!-- Row 2 -->
        <div class="rnum">2</div>
        <div class="cell">Marcus Reed</div>
        <div class="cell">Engineering</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">Beef</div>
        <div class="cell">—</div>
        <div class="cell">Ava Reed</div>
        <div class="cell">Fish</div>
        <div class="cell">5</div>
        <div class="cell">2</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">6:18 PM</div>
        <div class="cell"><span class="chk on"></span>✔</div>
        <div class="cell">Needs ADA access</div>

        <!-- Row 3 -->
        <div class="rnum">3</div>
        <div class="cell">Emily Tran</div>
        <div class="cell">Finance</div>
        <div class="cell"><span class="chk"></span>No</div>
        <div class="cell">Chicken</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">2</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell"><span class="chk"></span>—</div>
        <div class="cell">Out of town</div>

        <!-- Row 4 -->
        <div class="rnum">4</div>
        <div class="cell">Daniel Okafor</div>
        <div class="cell">Operations</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">Fish</div>
        <div class="cell"><span class="tag allergy">Shellfish</span></div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">7</div>
        <div class="cell">1</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">6:42 PM</div>
        <div class="cell"><span class="chk on"></span>✔</div>
        <div class="cell">Seat away from seafood buffet</div>

        <!-- Row 5 -->
        <div class="rnum">5</div>
        <div class="cell">Carlos Mendez</div>
        <div class="cell">IT</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">Chicken</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">3</div>
        <div class="cell">—</div>
        <div class="cell">7:03 PM</div>
        <div class="cell"><span class="chk on"></span>✔</div>
        <div class="cell">Volunteer photographer</div>

        <!-- Row 6 -->
        <div class="rnum">6</div>
        <div class="cell">Lena Cho</div>
        <div class="cell">Marketing</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">Veggie</div>
        <div class="cell"><span class="tag veggie">Vegan</span></div>
        <div class="cell">Noah Park</div>
        <div class="cell">Chicken</div>
        <div class="cell">2</div>
        <div class="cell">2</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">6:11 PM</div>
        <div class="cell"><span class="chk on"></span>✔</div>
        <div class="cell">Photo booth host 7–8 PM</div>

        <!-- Row 7 -->
        <div class="rnum">7</div>
        <div class="cell">Noah Patel</div>
        <div class="cell">Sales</div>
        <div class="cell"><span class="chk"></span>Pending</div>
        <div class="cell">Beef</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">0</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell"><span class="chk"></span>—</div>
        <div class="cell">Awaiting childcare</div>

        <!-- Row 8 -->
        <div class="rnum">8</div>
        <div class="cell">Priya Desai</div>
        <div class="cell">Legal</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">Fish</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">4</div>
        <div class="cell">—</div>
        <div class="cell">6:57 PM</div>
        <div class="cell"><span class="chk on"></span>✔</div>
        <div class="cell">Seated with HR</div>

        <!-- Row 9 -->
        <div class="rnum">9</div>
        <div class="cell">Arjun Mehta</div>
        <div class="cell">Data</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">Beef</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">6</div>
        <div class="cell">2</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">6:22 PM</div>
        <div class="cell"><span class="chk on"></span>✔</div>
        <div class="cell">Karaoke signup</div>

        <!-- Row 10 -->
        <div class="rnum">10</div>
        <div class="cell">Zoe Park</div>
        <div class="cell">Design</div>
        <div class="cell"><span class="chk on"></span>Yes</div>
        <div class="cell">Chicken</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">—</div>
        <div class="cell">1</div>
        <div class="cell">—</div>
        <div class="cell">7:15 PM</div>
        <div class="cell"><span class="chk on"></span>✔</div>
        <div class="cell">Gift exchange host</div>
      </div>
    </div>

    <!-- Tabs / status -->
    <div class="tabs">
      <button class="tabbtn active">Holiday_Party_List</button>
      <button class="tabbtn">Seating</button>
      <button class="tabbtn">Volunteers</button>
      <span class="status" id="statusText">Ready | Rows: 10</span>
    </div>
  </div>

<script>
  // CSV exporter
  document.getElementById('exportCsvBtn').addEventListener('click', () => {
    const headers = ["Full Name","Department","RSVP","Meal Pref","Allergies","+1 Name","+1 Meal","Table #","Drink Tickets","Gift Received","Arrival Time","Checked In","Notes"];
    const cells = Array.from(document.querySelectorAll('.grid .cell'));
    const rows = [];
    const COLS = headers.length;
    for (let i = 0; i < cells.length; i += COLS) {
      const row = cells.slice(i, i+COLS).map(td => {
        const txt = td.innerText.replace(/\s*\n\s*/g, ' ').trim();
        return /[",\n]/.test(txt) ? `"${txt.replace(/"/g, '""')}"` : txt;
      });
      rows.push(row);
    }
    const csv = [headers, ...rows].map(r => r.join(',')).join('\n');
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = Object.assign(document.createElement('a'), {href:url, download:'Holiday_Party_List.csv'});
    document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  });

  // Wrap text toggle for non-numeric cells
  document.getElementById('wrapBtn').addEventListener('click', ()=>{
    document.querySelectorAll('.cell').forEach(c=>{
      const wrapped = c.style.whiteSpace === 'normal';
      c.style.whiteSpace = wrapped ? 'nowrap' : 'normal';
    });
  });

  // Simple live counts (RSVP Yes and meal totals)
  function updateCounts(){
    const rows = Array.from(document.querySelectorAll('.grid .cell'));
    const COLS = 13;
    let yes = 0;
    const meals = {Chicken:0, Beef:0, Fish:0, Veggie:0};
    for(let i=0;i<rows.length;i+=COLS){
      const rsvp = rows[i+2]?.innerText || '';
      const meal = rows[i+3]?.innerText.trim();
      if(/Yes/i.test(rsvp)) yes++;
      if(meals.hasOwnProperty(meal)) meals[meal]++;
      // +1 meal
      const plusMeal = rows[i+6]?.innerText.trim();
      if(meals.hasOwnProperty(plusMeal)) meals[plusMeal]++;
    }
    document.getElementById('rsvpCount').textContent = `RSVP Yes: ${yes}`;
    document.getElementById('mealCounts').textContent =
      `Meals — Chicken: ${meals.Chicken}, Beef: ${meals.Beef}, Fish: ${meals.Fish}, Veggie: ${meals.Veggie}`;
  }
  updateCounts();
</script>
</body>
</html>
